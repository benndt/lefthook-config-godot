min_version: 2.0.0

pre-commit:
  jobs:
    - name: test
      group:
        parallel: true
        jobs:
          - name: gdunit
            glob: "*.gd"
            run: |
              godot_binary=$(echo "{godot_binary}" | sed "s/godot_binary/${GODOT_BIN}/" | tr -d '{}')
              gdunit_test_folder=$(echo "{gdunit_test_folder}" | sed "s/gdunit_test_folder/tests/" | tr -d '{}')
              gdunit_report_folder=$(echo "{gdunit_report_folder}" | sed "s/gdunit_report_folder/.reports/" | tr -d '{}')

              ./addons/gdUnit4/runtest.sh \
                --godot_binary ${godot_binary}
                --add ${gdunit_test_folder}
                --report-directory ${gdunit_report_folder}
                --report-count 1
                --continue